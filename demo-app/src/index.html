<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>DemoApp</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>
<body>
  <app-root></app-root>

  <script>
  
  // const nums = [1,2,3,4,5,6];

  // imperative programming - what and how
  // const doubleNums = []; // how
  // for (let x=0; x<nums; x++) { // how
    // doubleNums.push( // how
      // nums[x] * 2 //what
    // ); // how
  // }

  // declarative programming
  // map function has semantic meaning
  // const doubleNums = nums.map(n => n * 2 /* what */);

  // filter - // remove items from a new array based upon a predicate function
  // forEach - // to produce a side effect with each item in the array
  // nums.forEach(n => console.log(n));
  // reduce - can be used for anything 

  // console.log(nums); // [1,2,3,4,5,6]
  // console.log(doubleNums); // [2,4,68,10,12]


  
  </script>

  <!-- <script>
  
    const outer = () => {

      console.log('outer');

      let t = 2;

      setTimeout(function myTimeout1() {
        console.log('timeout 1');
        t = 4;
      }, 2000);

      const inner = () => {
        console.log('inner');
        console.log(t);
      };

      return inner;
    }

    const innerFn = outer();

    innerFn();

    setTimeout(function myTimeout2() {
      console.log('timeout 2');
      innerFn();
    }, 4000);

    // console.dir(innerFn);

  
  </script> -->

  <!-- <script>
  
    setTimeout(() => {
    
      console.log("fun");
    
    }, 0);
  
    console.log("happiness");
  
  
  </script> -->

  <script>
  
    const delay = () => Math.floor(Math.random() * 1000) + 500;

    /*
    setTimeout(() => {
      console.log('a');
      setTimeout(() => {
        console.log('b');
        setTimeout(() => {
          console.log('c');
        }, delay());
      }, delay());
    }, delay());
    */

    /*
    function allDone() {
      console.log('all done');
    }

    let counter = 0;

    counter++;
    setTimeout(() => {
      console.log('a');
      counter--;
      if (counter === 0) {
        allDone();
      }
    }, delay());
  
    counter++;
    setTimeout(() => {
      console.log('b');
      counter--;
      if (counter === 0) {
        allDone();
      }
    }, delay());

    counter++;
    setTimeout(() => {
      console.log('c');
      counter--;
      if (counter === 0) {
        allDone();
      }
    }, delay());

    */

  </script>
  <script>

    /*
    class Promise {
    
      constructor(fn) {

        this._resolveFns = [];
        this._rejectFns = [];
      
        const resolveFn = result => {
          this._resolveFns.forEach(fn => fn(result));
        };

        const rejectFn = result => {
          this._rejectFns.forEach(fn => fn(result));
        };

        fn(resolveFn, rejectFn);
      }

      then(fn) {
        this._resolveFns.push(fn);
      }

      catch(fn) {
        this._rejectFns.push(fn);
      }
    }
    */

    /*
    console.log('create promise');
    const p = new Promise((resolve, reject) => {
      console.log('run fn passed to promise constructor');

      setTimeout(() => {
        console.log('run fn passed to set timeout');
        resolve('a');
      }, delay());
    
    });

    console.log('pass a fn ref to promise then');
    p.then(result => {
      console.log('run fn passed to promise then');
      console.log(result);
    });

    console.log('made it here');
    */


    const taskA = () => {
      return new Promise(resolve => {
        setTimeout(() => {
          resolve('a');
        }, delay());
      });
    };

    const taskB = () => {
      return new Promise(resolve => {
        setTimeout(() => {
          resolve('b');
        }, delay());
      });
    };

    const taskC = () => {
      return new Promise((resolve, reject) => {
        setTimeout(() => {
          reject('c rejected');
        }, delay());
      });
    };

    /*
    taskA()
      .then(result => {
        console.log(result);
        return taskB();
      })
      .then(result => {
        console.log(result);
        return taskC();
      })
      .then(result => {
        console.log(result);
      });
    */

    
    Promise
      .all([ taskA(), taskB(), taskC() ])
      .then(results => {
        console.log('all done');
        console.log(results);
      })
      .catch(result => {
        console.log('catch fn');
        console.log(result);
      });
    

    /*
    const doTasksSeq = async () => {

      const resA = await taskA();
      console.log(resA);
    
      const resB = await taskB();
      console.log(resB);

      const resC = await taskC();
      console.log(resC);
    
    };

    doTasksSeq().then(() => console.log('finished them sequentially'));
    */

    /*
    const doTasksGrp = async () => {

      // try/catch can only be used with async/await for async operations
      try {
    
        const result = await Promise.all([ taskA(), taskB(), taskC()]);
        // const result = await Promise.allSettled([ taskA(), taskB(), taskC()]);

        console.log(result);
      
      } catch(err) {
        console.log('catch block');
        console.log(err)
      }
    
    };
    */

    //doTasksGrp().then(() => console.log('finished them a group'));

  
  </script>


</body>
</html>
